<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ĞšĞ»Ğ¸ĞºĞµÑ€: Ğ Ğ¾ÑÑĞ¸Ñ vs Ğ£ĞºÑ€Ğ°Ğ¸Ğ½Ğ°</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <style>
        body { font-family: Arial, padding: 10px; text-align: center; }
        button { padding: 12px 20px; margin: 5px; background: #0088cc; color: white; border: none; border-radius: 5px; }
        .scoreboard { margin-top: 15px; padding: 10px; background: #f0f0f0; border-radius: 5px; }
    </style>
</head>
<body>
    <div id="app">
        <div v-if="!userCountry">
            <h1>Ğ’Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ ÑÑ‚Ñ€Ğ°Ğ½Ñƒ</h1>
            <button @click="selectCountry('Russia')">ğŸ‡·ğŸ‡º Ğ Ğ¾ÑÑĞ¸Ñ</button>
            <button @click="selectCountry('Ukraine')">ğŸ‡ºğŸ‡¦ Ğ£ĞºÑ€Ğ°Ğ¸Ğ½Ğ°</button>
        </div>
        <div v-else>
            <h1>Ğ’Ñ‹ Ğ¸Ğ³Ñ€Ğ°ĞµÑ‚Ğµ Ğ·Ğ°: {{ userCountry }}</h1>
            <button @click="addClick">ĞšĞ›Ğ˜Ğš ({{ userClicks }})</button>
            <div class="scoreboard">
                <div>ğŸ‡·ğŸ‡º Ğ Ğ¾ÑÑĞ¸Ñ: {{ countryScores.Russia || 0 }}</div>
                <div>ğŸ‡ºğŸ‡¦ Ğ£ĞºÑ€Ğ°Ğ¸Ğ½Ğ°: {{ countryScores.Ukraine || 0 }}</div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/vue@3.2.47/dist/vue.global.prod.js"></script>

    <script>
        // ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ (Ğ·Ğ°Ğ¼ĞµĞ½Ğ¸Ñ‚Ğµ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸ÑĞ¼Ğ¸ Ğ¸Ğ· Firebase Console)
        const firebaseConfig = {
            apiKey: "AIzaSy...",
            authDomain: "my-miniapp-e609e.firebaseapp.com",
            databaseURL: "https://my-miniapp-e609e-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "my-miniapp-e609e",
            storageBucket: "my-miniapp-e609e.appspot.com",
            messagingSenderId: "123...",
            appId: "1:123...:web:abc..."
        };

        // Ğ˜Ğ½Ğ¸Ñ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Firebase
        firebase.initializeApp(firebaseConfig);
        console.log("Firebase Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡Ñ‘Ğ½ Ğº:", firebaseConfig.databaseURL);

        // Vue Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ
        const { createApp, ref, onMounted } = Vue;

        createApp({
            setup() {
                const tg = window.Telegram.WebApp;
                const userCountry = ref(null);
                const userClicks = ref(0);
                const countryScores = ref({ Russia: 0, Ukraine: 0 });

                // Ğ˜Ğ½Ğ¸Ñ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ±Ğ°Ğ·Ñ‹ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…
                onMounted(() => {
                    firebase.database().ref('countryScores').on('value', (snapshot) => {
                        const data = snapshot.val();
                        if (!data) {
                            // Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‘Ğ¼ ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ñƒ Ğ¿Ñ€Ğ¸ Ğ¿ĞµÑ€Ğ²Ğ¾Ğ¼ Ğ·Ğ°Ğ¿ÑƒÑĞºĞµ
                            firebase.database().ref('countryScores').set({
                                Russia: 0,
                                Ukraine: 0
                            });
                        } else {
                            countryScores.value = data;
                        }
                        console.log("Ğ¢ĞµĞºÑƒÑ‰Ğ¸Ğµ scores:", data || { Russia: 0, Ukraine: 0 });
                    });
                });

                // Ğ’Ñ‹Ğ±Ğ¾Ñ€ ÑÑ‚Ñ€Ğ°Ğ½Ñ‹
                const selectCountry = (country) => {
                    userCountry.value = country;
                    tg.expand();
                };

                // ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° ĞºĞ»Ğ¸ĞºĞ°
                const addClick = () => {
                    if (!userCountry.value) return;

                    userClicks.value++;
                    firebase.database().ref('countryScores/' + userCountry.value)
                        .transaction((current) => (current || 0) + 1)
                        .then(() => console.log("Ğ¡Ñ‡Ñ‘Ñ‚ Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»Ñ‘Ğ½"))
                        .catch(e => console.error("ĞÑˆĞ¸Ğ±ĞºĞ°:", e));
                };

                return { userCountry, userClicks, countryScores, selectCountry, addClick };
            }
        }).mount('#app');
    </script>
</body>
</html>